<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:HCIExplorer.ViewModels"
        xmlns:views="using:HCIExplorer.Views"
        xmlns:models="using:HCIExplorer.Models"
        xmlns:services="using:HCIExplorer.Services"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="1200" d:DesignHeight="800"
        x:Class="HCIExplorer.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Title="HCI Explorer - Clear-Com Eclipse HX"
        Width="1200" Height="800"
        MinWidth="800" MinHeight="600"
        Background="#1A2A3A">

    <Design.DataContext>
        <vm:MainWindowViewModel/>
    </Design.DataContext>

    <Grid RowDefinitions="Auto,*,Auto,250">
        <!-- Header / Connection Bar -->
        <Border Grid.Row="0" Background="#0066B3" Padding="16,12">
            <Grid ColumnDefinitions="Auto,*,Auto">
                <!-- Logo/Title -->
                <StackPanel Orientation="Horizontal" Spacing="12">
                    <TextBlock Text="HCI Explorer" 
                               FontSize="20" FontWeight="Bold" 
                               Foreground="White" 
                               VerticalAlignment="Center"/>
                    <Border Background="#004A82" CornerRadius="4" Padding="8,4">
                        <TextBlock Text="Clear-Com Eclipse HX" 
                                   FontSize="12" Foreground="#A8B4BE"/>
                    </Border>
                </StackPanel>
                
                <!-- Connection Controls -->
                <StackPanel Grid.Column="2" Orientation="Horizontal" Spacing="12">
                    <TextBlock Text="Host:" Foreground="White" VerticalAlignment="Center"/>
                    
                    <!-- ComboBox with editable text and discovered matrices -->
                    <ComboBox Width="200" 
                              IsEditable="True"
                              ItemsSource="{Binding DiscoveredMatrices}"
                              SelectedItem="{Binding SelectedDiscoveredMatrix}"
                              Text="{Binding HostAddress}"
                              IsDropDownOpen="{Binding IsDropdownOpen}"
                              PlaceholderText="Enter IP or select"
                              VerticalAlignment="Center">
                        <ComboBox.ItemTemplate>
                            <DataTemplate DataType="services:DiscoveredMatrix">
                                <StackPanel>
                                    <TextBlock Text="{Binding IpAddress}" FontWeight="SemiBold"/>
                                    <TextBlock Text="{Binding DisplayName}" 
                                               FontSize="10" 
                                               Foreground="#808080"/>
                                </StackPanel>
                            </DataTemplate>
                        </ComboBox.ItemTemplate>
                    </ComboBox>
                    
                    <!-- Discovery indicator -->
                    <Border Background="#004A82" 
                            CornerRadius="4" 
                            Padding="6,4" 
                            VerticalAlignment="Center"
                            IsVisible="{Binding IsDiscoveryActive}">
                        <StackPanel Orientation="Horizontal" Spacing="4">
                            <TextBlock Text="ðŸ”" FontSize="12"/>
                            <TextBlock Text="{Binding DiscoveredMatrices.Count, StringFormat='Found: {0}'}" 
                                       FontSize="11" 
                                       Foreground="#81C784"/>
                        </StackPanel>
                    </Border>
                    
                    <Button Content="{Binding ConnectButtonText}"
                            Command="{Binding ConnectCommand}"
                            Classes="secondary"
                            Width="100"/>
                    <Border CornerRadius="4" Padding="8,4" VerticalAlignment="Center">
                        <Border.Styles>
                            <Style Selector="Border">
                                <Setter Property="Background" Value="#EF5350"/>
                            </Style>
                            <Style Selector="Border[IsVisible=true]">
                                <Setter Property="Background" Value="#81C784"/>
                            </Style>
                        </Border.Styles>
                        <TextBlock Text="{Binding ConnectionStatus}" Foreground="White" FontSize="12"/>
                    </Border>
                </StackPanel>
            </Grid>
        </Border>
        
        <!-- Main Content - Tabbed Interface -->
        <TabControl Grid.Row="1" Margin="0">
            <TabItem Header="System">
                <views:SystemRequestsView DataContext="{Binding SystemRequests}"/>
            </TabItem>
            <TabItem Header="Panels">
                <views:PanelRequestsView DataContext="{Binding PanelRequests}"/>
            </TabItem>
            <TabItem Header="Crosspoints">
                <views:CrosspointRequestsView DataContext="{Binding CrosspointRequests}"/>
            </TabItem>
            <TabItem Header="Conferences">
                <views:ConferenceRequestsView DataContext="{Binding ConferenceRequests}"/>
            </TabItem>
            <TabItem Header="Telephony">
                <views:TelephonyRequestsView DataContext="{Binding TelephonyRequests}"/>
            </TabItem>
            <TabItem Header="Cards">
                <views:CardRequestsView DataContext="{Binding CardRequests}"/>
            </TabItem>
            <TabItem Header="Beltpacks">
                <views:BeltpackRequestsView DataContext="{Binding BeltpackRequests}"/>
            </TabItem>
            <TabItem Header="Misc">
                <views:MiscRequestsView DataContext="{Binding MiscRequests}"/>
            </TabItem>
        </TabControl>
        
        <!-- Splitter -->
        <GridSplitter Grid.Row="2" Height="6" Background="#2D3740" 
                      HorizontalAlignment="Stretch" VerticalAlignment="Center"
                      ShowsPreview="True"/>
        
        <!-- Log Panel -->
        <views:LogViewerControl Grid.Row="3"/>
    </Grid>
</Window>
